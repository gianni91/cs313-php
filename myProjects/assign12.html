<?xml version = "1.0" encoding = "utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns = "http://www.w3.org/1999/xhtml">

<head>
  <link rel = "stylesheet" type = "text/css" href = "formValidSheet.css" />
  <title>Concert Registration</title>
  <script>
    function showSecond()
    {
        if(document.getElementById("performanceType").value == "duet")
       {
          document.getElementById("firstName2").style.visibility = "visible";
          document.getElementById("lastName2").style.visibility = "visible";
          document.getElementById("studentId2").style.visibility = "visible";
       }
       else
       {
          document.getElementById("firstName2").style.visibility = "hidden";
          document.getElementById("lastName2").style.visibility = "hidden";
          document.getElementById("studentId2").style.visibility = "hidden";
       }
    }

    function verifyText()
    {
       if(document.getElementById("firstName").value == "")
       {
           document.getElementById("firstName").focus();
           return false;
       }
       else if(document.getElementById("lastName").value == "")
       {
           document.getElementById("lastName").focus();
          return false;
       }
       else if(document.getElementById("studentId").value == "")
       {
           document.getElementById("studentId").focus();
          return false;
       }
       else if(document.getElementById("location").value == "")
       {
           document.getElementById("location").focus();
          return false;
       }
       else if(document.getElementById("roomNumber").value == "")
       {
           document.getElementById("roomNumber").focus();
          return false;
       }
       if(document.getElementById("performanceType").value == "duet")
       {
         if(document.getElementById("firstName2").value == "")
         {
            document.getElementById("firstName2").focus();
            return false;
         }
         else if(document.getElementById("lastName2").value == "")
         {
            document.getElementById("lastName2").focus();
            return false;
         }
         else if(document.getElementById("studentId2").value == "")
         {
            document.getElementById("studentId2").focus();
            return false;
          }
       }
       else 
          return true;
    }   

    function loadText(task)
    {
       loadTextB(task,1);

       if(document.getElementById("performanceType").value == "duet")
         loadTextB(task,2);
    }

    function loadTextB(task, numStudent)
    {
    if(task != 0 && verifyText() == false)
       return;
    else
    {
    var myRequest = new XMLHttpRequest();

    var urlMod = "http://157.201.194.254/~jjob2/assign12.php?performanceType=";

// Create the Query string 
    var performanceType = document.getElementById("performanceType").value;
    urlMod += performanceType;

    if(numStudent == 2)
    {  
      var firstName = document.getElementById("firstName2").value;
      urlMod += ("&firstName=" + firstName);

      var lastName = document.getElementById("lastName2").value;
      urlMod += ("&lastName=" + lastName);

      var studentId = document.getElementById("studentId2").value;
      urlMod += ("&studentId=" + studentId);
    }
    else
    {
      var firstName = document.getElementById("firstName").value;
      urlMod += ("&firstName=" + firstName);

      var lastName = document.getElementById("lastName").value;
      urlMod += ("&lastName=" + lastName);

      var studentId = document.getElementById("studentId").value;
      urlMod += ("&studentId=" + studentId);
    }

    var skillLevel = document.getElementById("skillLevel").value;
    urlMod += ("&skillLevel=" + skillLevel);

    var instrument = document.getElementById("instrument").value;
    urlMod += ("&instrument=" + instrument);

    var location = document.getElementById("location").value;
    urlMod += ("&location=" + location);

    var roomNumber = document.getElementById("roomNumber").value;
    urlMod += ("&roomNumber=" + roomNumber);

    var time = document.getElementById("time").value;
    urlMod += ("&time=" + time);

    if(task == 1)
      urlMod += "&choice=Register";
    else
      urlMod += "&choice=Clear";

  
    myRequest.open("GET",urlMod,true);

    myRequest.onreadystatechange=function()
    {
       if (myRequest.readyState==4 && myRequest.status==200)
          display();
    }

      myRequest.send();
    }
   }

   function display()
   {
      var myRequest = new XMLHttpRequest();

      myRequest.onreadystatechange=function()
      {    
        if (myRequest.readyState==4 && myRequest.status==200)
        {  
          var rText = myRequest.responseText;
          var rSplit = rText.split('\n'); 

          var tableString = 
            "<table border=\x224\x22 cellpadding=\x2210\x22>" +
            "<tr><th>Type</th><th>Name</th>" +
            "<th>Student ID</th>"+ "<th>Skill Level</th>" +
            "<th>Instrument</th>"+ "<th>Location</th>"+ "<th>Room</th>" +
            "<th>Time</th>";
          if(rText=="")
          {
             tableString += "<tr><td></td><td></td><td></td><td></td>";
             tableString += "<td></td><td></td><td></td><td></td></tr>";
          }
          else
          {
            var cSplit;
            for(var i = 0; i < rSplit.length -1; i++)
            {
              cSplit = rSplit[i].split('++');

             tableString += "<tr>";
             for(var j = 0; j < 8; j++)
             {
               tableString += ("<td>"+cSplit[j]+"</td>");
             }
             tableString += "</tr>";
            }
          } 
          tableString += "</table>";

          document.getElementById("registry").innerHTML = tableString;
        }
      }
      myRequest.open("GET","readWrite/pianoFest.txt?",true); 

      myRequest.send();
    }

    function clearForm()
    {
       document.getElementById("performanceType").value = "solo";
       document.getElementById("firstName").value = "";
       document.getElementById("firstName2").value = "";
       document.getElementById("lastName").value = "";
       document.getElementById("lastName2").value = "";
       document.getElementById("studentId").value = "";
       document.getElementById("studentId2").value = "";
       document.getElementById("skillLevel").value = "beginner";
       document.getElementById("instrument").value = "piano";
       document.getElementById("location").value = "";
       document.getElementById("roomNumber").value = "";
       document.getElementById("time").value = "8:00am";
       document.getElementById("firstName2").style.visibility = "hidden";
       document.getElementById("lastName2").style.visibility = "hidden";
       document.getElementById("studentId2").style.visibility = "hidden";
    }  
  </script>
</head>

<body onload=display();showSecond()>
  <h1> Piano Festival Registration </h1>
<table style="background-color:skyBlue " align="center">
<tr>
<th>Performance Type:</th>
<td>
  <select name="performanceType" id="performanceType" onchange="showSecond()">
    <option value="solo">Solo</option>
    <option value="duet">Duet</option>
    <option value="concierto">Concierto</option>
  </select>
</td>
</tr>
<tr>
<th>
  First Name:
</th>
<td>
  <input type="text" name="firstName" id="firstName"></input>
  <input type="text" name="firstName2" id="firstName2"
         style="visibility:hidden"></input>
</td>
</tr>
<tr>
<th>
  Last Name:
</th>
<td>
  <input type="text" name="lastName" id="lastName"></input>
  <input type="text" name="lastName2" id="lastName2"></input>
</td>
</tr>
<tr>
<th>
  Student ID:
</th>
<td>
 <input type="text" name="studentId" id="studentId"></input>  
 <input type="text" name="studentId2" id="studentId2"></input>
</td>
</tr>
<tr>
<th>
  Skill Level:
</th>
<td>
  <select name="skillLevel" id="skillLevel">
    <option value="beginner">Beginner</option>
    <option value="intermadiate">Intermediate</option>
    <option value="pre-advanced">Pre-advanced</option>
    <option value="advanced">Advanced</option>
  </select>
</td>
</tr>
<tr>
<th>
  Instrument:
</th>
<td>
  <select name="instrument" id="instrument">
    <option value="piano">Piano</option>
    <option value="voice">Voice</option>
    <option value="string">String</option>
    <option value="organ">Organ</option>
    <option value="other">Other</option>
  </select>
</td>
</tr>
<tr>
<th>
  Location: 
</th>
<td>
  <input type="text" name="location" id="location"></input>
</td>
</tr>
<tr>
<th>
  Room #:
</th>
<td>
  <input type="text" name="roomNumber" id="roomNumber"></input>
</td>
</tr>
<tr>
<th>
  Time:
</th>
<td>
  <select name="time" id="time">
    <option value="8:00am">8:00am</option>
    <option value="8:15am">8:15am</option>
    <option value="8:30am">8:30am</option>
    <option value="8:45am">8:45am</option>
    <option value="9:00am">9:00am</option>
    <option value="9:15am">9:15am</option>
    <option value="9:30am">9:30am</option>
    <option value="9:45am">9:45am</option>
    <option value="10:00am">10:00am</option>
    <option value="10:15am">10:15am</option>
    <option value="10:30am">10:30am</option>
    <option value="10:45am">10:45am</option>
  </select>
</td>
</tr>
<tr>
<th>
</th>
</tr>
</table>
<br />
<div align="center">
  <button name="button" onclick="loadText(1);verifyText()" value="Register">
    Register Student</button>
  <button name="button" onclick="clearForm()" value="Clear">Clear Form</button>
  <button name="button" onclick="loadText(0)" value="Clear">Clear List</button>
</div>
  <br />
  <br />
  <div id="registry" name="registry" align="center"> </div>
</body>
</html>
